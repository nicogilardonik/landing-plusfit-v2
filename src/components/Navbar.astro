---
import { Zap, Facebook, Instagram, Menu, X } from "lucide-astro";
---

<nav
  id="navbar"
  class="fixed w-full z-50 transition-all duration-500 ease-out py-6 border-b border-white/5"
>
  <div class="container mx-auto px-6 flex justify-between items-center">
    <!-- Logo Area -->
    <a href="#inicio" class="relative z-50 group" aria-label="Volver arriba">
      <div class="flex items-center gap-2">
        <!-- Premium Logo Placeholder or Image -->
        <img
          src="/images/logo-light.png"
          alt="+FIT.PRO"
          class="h-10 md:h-12 w-auto object-contain transition-transform duration-500 group-hover:scale-105 group-hover:drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"
        />
      </div>
    </a>

    <!-- Desktop Menu -->
    <div class="hidden md:flex items-center gap-4 lg:gap-12">
      <div
        class="flex items-center gap-4 lg:gap-8 bg-white/5 backdrop-blur-md px-6 lg:px-8 py-3 rounded-full border border-white/10 shadow-2xl"
      >
        {
          [
            "Inicio",
            "Misión",
            "App",
            "Filosofía",
            "Nutrición",
            "Team",
            "Planes",
            "FAQ",
          ].map((item) => (
            <a
              href={`#${item.toLowerCase().replace("ñ", "n").replace("í", "i").replace("ó", "o")}`}
              class="relative text-xs font-bold uppercase tracking-[0.2em] text-gray-300 hover:text-white transition-colors duration-300 group"
              style="font-family: 'Inter', sans-serif;"
            >
              {item}
              <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-brand-yellow transition-all duration-300 group-hover:w-full box-shadow-[0_0_10px_#FACC15]" />
            </a>
          ))
        }
      </div>

      <div class="h-8 w-px bg-white/10"></div>

      <!-- Socials & Theme (Simplified for Premium Dark Mode mainly) -->
      <div class="flex gap-4">
        <a
          href="https://www.facebook.com/profile.php?id=100085185212046"
          target="_blank"
          class="w-10 h-10 rounded-full bg-white/5 hover:bg-brand-yellow hover:text-black border border-white/10 flex items-center justify-center transition-all duration-300 group"
        >
          <Facebook class="w-4 h-4" />
        </a>
        <a
          href="https://www.instagram.com/plus.fituy/?hl=es-la"
          target="_blank"
          class="w-10 h-10 rounded-full bg-white/5 hover:bg-brand-yellow hover:text-black border border-white/10 flex items-center justify-center transition-all duration-300 group"
        >
          <Instagram class="w-4 h-4" />
        </a>
      </div>
    </div>

    <!-- Mobile Toggle -->
    <button
      id="mobile-menu-toggle"
      class="md:hidden relative z-50 text-white hover:text-brand-yellow transition-colors"
    >
      <Menu id="menu-icon" class="w-8 h-8" />
      <X id="close-icon" class="hidden w-8 h-8" />
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu"
    class="fixed inset-0 bg-brand-blue/95 backdrop-blur-xl z-40 flex items-center justify-center transition-all duration-500 opacity-0 pointer-events-none translate-y-10"
  >
    <div class="flex flex-col items-center gap-8 text-center p-6">
      {
        [
          "Inicio",
          "Misión",
          "App",
          "Filosofía",
          "Nutrición",
          "Team",
          "Planes",
          "FAQ",
        ].map((item, index) => (
          <a
            href={`#${item.toLowerCase().replace("ñ", "n").replace("í", "i").replace("ó", "o")}`}
            class="mobile-nav-link text-3xl font-heading font-bold text-white uppercase tracking-widest hover:text-brand-yellow transition-all duration-300 transform translate-y-4 opacity-0"
            style={`transition-delay: ${index * 100}ms`}
          >
            {item}
          </a>
        ))
      }
    </div>
  </div>
</nav>

<script>
  const navbar = document.getElementById("navbar");
  const toggleBtn = document.getElementById("mobile-menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const links = document.querySelectorAll(".mobile-nav-link");

  const updateNavbar = () => {
    const isScroll = window.scrollY > 50;
    const isOpen = !mobileMenu?.classList.contains("pointer-events-none");

    // Base padding adjustments based on scroll
    if (isScroll) {
      navbar?.classList.add("py-4");
      navbar?.classList.remove("py-6");
    } else {
      navbar?.classList.add("py-6");
      navbar?.classList.remove("py-4");
    }

    if (isOpen) {
      // MENU OPEN: Transparent to blend with overlay
      navbar?.classList.remove(
        "bg-brand-blue/90",
        "backdrop-blur-xl",
        "shadow-xl",
        "border-white/5",
      );
      navbar?.classList.add("bg-transparent", "border-transparent");

      // Icons
      menuIcon?.classList.add("hidden");
      closeIcon?.classList.remove("hidden");

      // Body Lock
      document.body.style.overflow = "hidden";
    } else {
      // MENU CLOSED: Standard behavior
      navbar?.classList.remove("bg-transparent", "border-transparent");
      navbar?.classList.add("border-white/5"); // Restore border color

      if (isScroll) {
        navbar?.classList.add(
          "bg-brand-blue/90",
          "backdrop-blur-xl",
          "shadow-xl",
        );
      } else {
        navbar?.classList.remove(
          "bg-brand-blue/90",
          "backdrop-blur-xl",
          "shadow-xl",
        );
        navbar?.classList.add("bg-transparent");
      }

      // Icons
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");

      // Body Unlock
      document.body.style.overflow = "";
    }
  };

  // Scroll Listener
  window.addEventListener("scroll", updateNavbar);

  // Toggle Listener
  toggleBtn?.addEventListener("click", () => {
    const isOpen = !mobileMenu?.classList.contains("pointer-events-none");

    if (isOpen) {
      // Close
      mobileMenu?.classList.add(
        "opacity-0",
        "pointer-events-none",
        "translate-y-10",
      );
      links.forEach((l) => l.classList.remove("opacity-100", "translate-y-0"));
    } else {
      // Open
      mobileMenu?.classList.remove(
        "opacity-0",
        "pointer-events-none",
        "translate-y-10",
      );
      setTimeout(() => {
        links.forEach((l) => l.classList.add("opacity-100", "translate-y-0"));
      }, 200);
    }

    // Defer update slightly to allow class changes to register if needed,
    // though here we are just reading the class we just toggled?
    // Actually, we toggled the class on mobileMenu above.
    // so calling updateNavbar immediately is fine.
    updateNavbar();
  });

  // Link Click Listener
  links.forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu?.classList.add(
        "opacity-0",
        "pointer-events-none",
        "translate-y-10",
      );
      updateNavbar(); // Will handle closing logic
    });
  });

  // Initial call
  updateNavbar();
</script>
